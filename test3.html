<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Cata VR - Gorri贸n Wine Experience</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- A-Frame (versi贸n compatible con WebXR Viewer) -->
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>

    <style>
      body {
        margin: 0;
        overflow: hidden;
        background-color: black;
        font-family: sans-serif;
      }
      #enter-vr-btn {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background-color: #9b2b2b;
        color: white;
        border: none;
        padding: 14px 22px;
        font-size: 16px;
        border-radius: 8px;
        cursor: pointer;
        z-index: 999;
      }
      #enter-vr-btn:hover {
        background-color: #d45b5b;
      }
    </style>
  </head>

  <body>
    <a-scene
      vr-mode-ui="enabled: true"
      loading-screen="dotsColor: #9b2b2b; backgroundColor: black"
    >
      <!-- Fondo 360掳 -->
      <a-sky src="nieve2.jpg" rotation="0 -90 0" material="shader: flat; side: back;"></a-sky>

      <!-- Luz ambiental -->
      <a-entity light="type: ambient; color: #FFF"></a-entity>

      <!-- Texto de bienvenida -->
      <a-text
        value=" Bienvenido a la Cata VR Gorri贸n Wine Experience "
        align="center"
        color="#ffffff"
        position="0 2 -3"
        width="6"
      ></a-text>

      <!-- Punto interactivo -->
      <a-sphere
        id="boton-cata"
        position="0 1.5 -3"
        radius="0.25"
        color="#9b2b2b"
        event-set__enter="_event: mouseenter; color: #d45b5b"
        event-set__leave="_event: mouseleave; color: #9b2b2b"
        sound="on: click; src: #audio-cata"
      ></a-sphere>

      <!-- Texto gu铆a -->
      <a-text
        value="Mira el c铆rculo para comenzar la cata"
        align="center"
        color="#fff"
        position="0 0.9 -3"
        width="4"
      ></a-text>

      <!-- Audio -->
      <audio
        id="audio-cata"
        src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_aa4f7c59ed.mp3?filename=wine-pour-23695.mp3"
      ></audio>

      <!-- C谩mara + Cursor -->
      <a-entity camera look-controls="magicWindowTrackingEnabled: true">
        <a-cursor
          fuse="true"
          fuse-timeout="1500"
          material="color: white; shader: flat"
        ></a-cursor>
      </a-entity>
    </a-scene>

    <!-- Bot贸n de entrada a modo VR -->
    <button id="enter-vr-btn">Entrar en modo VR</button>

    <script>
      const scene = document.querySelector("a-scene");
      const vrButton = document.getElementById("enter-vr-btn");

      // Detectar si el usuario est谩 en WebXR Viewer
      const isWebXRViewer = /WebXRViewer/i.test(navigator.userAgent);
      const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);

      // Si no est谩 en WebXR Viewer ni Android, ocultar el bot贸n VR
      if (!isWebXRViewer && isIOS) {
        vrButton.textContent =
          "Modo VR no disponible en Safari iPhone. Usa WebXR Viewer ";
      }

      vrButton.addEventListener("click", () => {
        if (scene && scene.enterVR) {
          scene.enterVR();
          vrButton.style.display = "none";
        }
      });

      scene.addEventListener("exit-vr", () => {
        vrButton.style.display = "block";
      });
    </script>
  </body>
</html>
